#!/bin/ksh
#
###################################################################################
#
# Configuration file for module "int2lm"
#
# USAGE: source ./int2lm_conf.sh model
#
#   - 'model': NWP model; options: COSMO|ICON-LAM
#
# DESCRIPTION: collects parameters needed for modul 'int2lm'
#
# HISTORY:
#
#   - hreich 2017/11: first version for unified bacy BACY_1.0
#   - hreich 2018/07: 'model' as input argument added
#
###################################################################################
#
#
###################################################################################
# Begin of configuration script
#==================================================================================
if [ -z "$__INT2LM_CONF__" ]; then __INT2LM_CONF__=defined    # include-guard begin
###################################################################################
#
#
###################################################################################
# For error handling
#==================================================================================
source $BC_COMMON/error_fcns.sh
trap 'f_error_handler $LINENO ER_msg' ERR
f_error_push_stacks SCRIPT "$0" "${.sh.file}"
###################################################################################
#
#
###################################################################################
# Checking input arguments
#==================================================================================
if [ "$#" -ne 1 ]; then
  f_error_set_msg_and_send 1 ER_msg \
    "Wrong number ($#) of arguments while sourcing" \
    "'${.sh.file}'."
fi
#----------------------------------------------------------------------------------
case "$1" in
  !(COSMO|ICON-LAM))
    f_error_set_msg_and_send 1 ER_msg \
      "Wrong value ($1) for first input argument while sourcing" \
      "'${.sh.file}'."
esac
###################################################################################
#
#
###################################################################################
# General configuration
#==================================================================================
f_call_set_var  BC_EXPID        ${CY_EXPID:-0001}
###################################################################################
#
#
###################################################################################
# Location of COSMO/ICON-LAM grid description, external parameters, invariant data
#==================================================================================
f_call_set_var  BC_C_CONSTDIR       ${BA_ROUTFORFOX}/lm/const
#----------------------------------------------------------------------------------
f_call_set_var  BC_BCCONSTDIR       ${BA_PATH}/const/bc_const
###################################################################################
#
#
###################################################################################
# Job specific parameters
#==================================================================================
case "$1" in
  COSMO)     f_call_set_var  BC_BIN         ${BA_PATH}/bin/tstint2lm;;
  ICON-LAM)  f_call_set_var  BC_BIN         ${BA_PATH}/bin/iconremap;
esac
###################################################################################
#
#
###################################################################################
# Parameter to define whether precalculated boundary files shall be used
#==================================================================================
f_call_set_var  BC_USE_PRECALC_ASS    0                  # for assimilation   0|1|2
f_call_set_var  BC_USE_PRECALC_MAIN   0                  # for forecast       0|1|2
#----------------------------------------------------------------------------------
f_call_set_var  BC_PRECALCDIR_ASS     ${BA_PATH}/precalc/ASS
f_call_set_var  BC_PRECALCDIR_MAIN    ${BA_PATH}/precalc/MAIN
##################################################################################
#
#
###################################################################################
# Batch specific parameters (for submitting the ensemble runs as small batches;
# otherwise the hpc will be cramped)
#==================================================================================
f_call_set_var  BC_BLOCKSIZE    4
###################################################################################
#
#
###################################################################################
# Local model specific parameters
#==================================================================================
f_call_set_var BC_L_BC_MAIN_IEU_DIR  ${BA_PATH}/boundary_data
#==================================================================================
case "$BC_IN_MODEL:$BC_IN_MODE" in       # run MAIN (ILAM) with interp. ICON-EU 0|1
  ICON-LAM:MAIN)
    f_call_set_var  BC_L_MAIN_FROM_IEU  1
  ;;
esac
###################################################################################
#
#
###################################################################################
# End of configuration file
#==================================================================================
f_error_end_of_script
#----------------------------------------------------------------------------------
fi                                                              # include-guard end
###################################################################################
